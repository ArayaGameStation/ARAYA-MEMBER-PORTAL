<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ARAYA MEMBER PORTAL</title>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --bg: #080A1A;
      --card-bg-image: url('https://i.imgur.com/nwbUELc.jpeg');
      --line: rgba(0, 191, 255, 0.2);
      --text: #E0FFFF;
      --muted: #9BBCEF;
      --primary: #00BFFF;
      --secondary: #00FFFF;
      --accent: #ADD8E6;
      --bronze: linear-gradient(135deg, #8c4a2f 0%, #b87333 50%, #ff9f50 100%);
      --silver: linear-gradient(135deg, #cbd8e6 0%, #a4c9f0 50%, #7abfff 100%);
      --gold: linear-gradient(135deg, #ffce00 0%, #ffb800 50%, #ff9e00 100%);
    }

    /* Video Background */
    #bg-video {
      position: fixed;
      right: 0;
      bottom: 0;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      z-index: -1;
      background: var(--bg);
      object-fit: cover;
      filter: brightness(0.4);
    }
    
    /* Global Styles */
    *, ::before, ::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      background: rgba(0, 0, 0, 1);
      color: var(--text);
      line-height: 1.6;
      overflow-x: hidden;
      position: relative;
    }
    a { text-decoration: none; }
    h1, h2, h3 {
      font-family: 'Orbitron', sans-serif;
      color: var(--secondary);
      margin-bottom: 0.8rem;
      text-shadow: 0 0 15px var(--secondary);
      transition: color 0.3s, text-shadow 0.3s;
    }
    h1 { font-size: 3.8rem; letter-spacing: 3px; }
    h2 { font-size: 3rem; text-shadow: 0 0 12px var(--secondary); }
    h3 { font-size: 1.8rem; color: var(--primary); }
    section { padding: 5rem 1.25rem; position: relative; z-index: 1; }
    .container { max-width: 1100px; margin: 0 auto; padding: 0 1rem; }
    .btn {
      padding: .8rem 2rem;
      border: 2px solid var(--primary);
      background: rgba(0, 191, 255, 0.08);
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      transition: .3s ease-in-out;
      display: inline-block;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      overflow: hidden;
      color: var(--primary);
      box-shadow: 0 0 10px rgba(0, 191, 255, 0.3);
    }
    .btn.primary {
      background: var(--primary);
      color: var(--bg);
      border-color: var(--primary);
      box-shadow: 0 0 20px rgba(0, 191, 255, 0.6);
    }
    .btn.accent {
      background: var(--accent);
      color: var(--bg);
      border-color: var(--accent);
      box-shadow: 0 0 20px rgba(173, 216, 230, 0.6);
    }
    .btn.ghost {
      background: transparent;
      border: 2px solid var(--secondary);
      color: var(--secondary);
    }
    .btn:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 0 25px var(--secondary), 0 0 40px var(--primary);
      border-color: var(--secondary);
    }
    .btn:disabled { cursor: not-allowed; opacity: .5; }

    /* Card */
    .card {
      position: relative;
      border: 1px solid var(--line);
      border-radius: 6px;
      padding: 2rem;
      margin-bottom: 1.5rem;
      background: rgba(18, 20, 35, 0.8);
      box-shadow: 0 0 10px rgba(0, 191, 255, 0.2);
      transition: transform .4s, box-shadow .4s, border-color .4s;
      overflow: hidden;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--card-bg-image) no-repeat center center/cover;
      opacity: 0.05;
      z-index: 0;
      filter: saturate(0.8) contrast(1.1);
    }
    .card > *, .card h3 {
      position: relative;
      z-index: 1;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 255, 255, 0.3);
      border-color: var(--secondary);
    }

    /* Form & Input */
    input {
      padding: .9rem;
      border-radius: 4px;
      border: 1px solid var(--line);
      background: rgba(18, 20, 35, 0.9);
      color: var(--text);
      width: 100%;
      margin-bottom: 1rem;
      font-family: 'Poppins', sans-serif;
      transition: all .3s ease;
    }
    input:focus {
      outline: none;
      border-color: var(--secondary);
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.4);
    }

    /* Grid & List */
    .grid { display: grid; gap: 2rem; }
    .grid-3 { grid-template-columns: repeat(3, 1fr); }
    ul { margin-left: 1.5rem; list-style: none; }
    ul li { position: relative; padding-left: 1.5rem; margin-bottom: .6rem; }
    ul li::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 8px;
      height: 8px;
      background: var(--secondary);
      border-radius: 50%;
      box-shadow: 0 0 8px var(--secondary);
    }

    /* Tier Cards */
    .tier {
      border-radius: 6px;
      text-align: left;
      position: relative;
      overflow: hidden;
      transition: transform .3s, box-shadow .3s;
      background: rgba(18, 20, 35, 0.9);
      border: 1px solid;
    }
    .tier h3 { color: var(--text); text-shadow: none; text-align: center; }
    .tier.bronze {
      background: var(--bronze);
      border-color: var(--bronze);
      box-shadow: 0 0 10px rgba(205, 127, 50, .35);
    }
    .tier.silver {
      background: var(--silver);
      border-color: var(--silver);
      box-shadow: 0 0 10px rgba(192, 192, 192, .35);
    }
    .tier.gold {
      background: var(--gold);
      border-color: var(--gold);
      box-shadow: 0 0 10px rgba(255, 215, 0, .4);
    }
    .tier p strong { color: var(--text); }
    .tier ul li {
      font-weight: 500;
      color: var(--text);
      text-shadow: none;
      padding-left: 1.5rem;
    }
    .tier ul li::before {
      background: var(--secondary);
      box-shadow: 0 0 5px var(--secondary);
    }
    .tier:hover {
      transform: translateY(-8px);
    }

    /* Tabs Leaderboard */
    .tabs { display: flex; flex-wrap: wrap; gap: .8rem; justify-content: center; margin: 1.5rem 0 1.5rem; }
    .tab-btn {
      background: rgba(18, 20, 35, 0.8);
      color: var(--primary);
      border: 1px solid var(--primary);
      border-radius: 4px;
      padding: .6rem 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: .2s;
    }
    .tab-btn.active {
      background: var(--primary);
      color: var(--bg);
      box-shadow: 0 0 10px rgba(0, 191, 255, 0.5);
      border-color: var(--primary);
    }

    /* Leaderboard Table */
    .leaderboard-container {
      background: rgba(18, 20, 35, 0.8);
      width: 100%;
      max-height: 550px;
      overflow-y: auto;
      box-shadow: 0 0 10px rgba(0, 191, 255, 0.2);
      border: 1px solid var(--line);
      border-radius: 6px;
      opacity: 1;
      transition: opacity 0.3s ease-in-out;
    }
    .leaderboard-container.fade-out { opacity: 0; }
    .leaderboard-container::-webkit-scrollbar { width: 8px; }
    .leaderboard-container::-webkit-scrollbar-thumb { background-color: var(--primary); border-radius: 4px; }
    .leaderboard-container::-webkit-scrollbar-track { background-color: transparent; }
    table { width: 100%; border-collapse: collapse; color: #fff; }
    th, td { padding: 12px 14px; border-bottom: 1px solid rgba(0, 191, 255, .1); text-align: center; }
    th {
      background: linear-gradient(90deg, rgba(18, 20, 35, 0.9), rgba(28, 30, 45, 0.9));
      color: var(--primary);
      letter-spacing: .5px;
      position: sticky;
      top: 0;
      z-index: 1;
      text-transform: uppercase;
      font-family: 'Orbitron', sans-serif;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    }
    tr:nth-child(even) { background: rgba(0, 255, 255, 0.03); }
    tr:hover { background: rgba(0, 191, 255, .1); transition: .25s; }

    /* Member ID Card */
    .member-card {
      width: 100%;
      max-width: 340px;
      height: 200px;
      border: 1px solid var(--primary);
      border-radius: 6px;
      box-shadow: 0 0 15px rgba(0, 191, 255, .4);
      margin: 1.5rem auto;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      text-align: left;
      position: relative;
      background: var(--card-bg-image) no-repeat center center/cover;
      background-position: 50% 50%;
      background-size: cover;
      color: var(--text);
      overflow: hidden;
      transform: translateZ(0);
      transition: box-shadow 0.4s ease-in-out, transform 0.3s ease-out;
    }
    .member-card:hover {
      box-shadow: 0 0 30px var(--secondary);
      transform: translateY(-5px);
    }
    .member-card::before, .member-card::after { content: none; }
    .member-card::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1;
    }
    .member-card h3 {
      font-size: 1rem;
      color: var(--secondary);
      text-shadow: none;
      top: 1.2rem;
      left: 1rem;
      position: absolute;
      z-index: 2;
    }
    .member-card .id {
      position: absolute;
      top: 1.2rem;
      right: 1rem;
      font-size: 1rem;
      color: var(--muted);
      text-shadow: none;
      font-family: 'Orbitron', sans-serif;
      z-index: 2;
    }
    .member-card .name {
      font-size: 1.5rem;
      font-weight: 500;
      text-align: center;
      margin: 35px 0 5px 0;
      text-shadow: none;
      position: relative;
      z-index: 2;
    }
    .member-card .tier {
      font-size: 1rem;
      text-align: center;
      margin: 0;
      font-family: 'Orbitron', sans-serif;
      text-shadow: none;
      position: relative;
      z-index: 2;
    }
    .member-card .tier.gold { color: var(--gold); }
    .member-card .tier.silver { color: var(--silver); }
    .member-card .tier.bronze { color: var(--bronze); }
    .member-card .validity {
      font-size: 1rem;
      color: var(--muted);
      text-align: center;
      margin: 5px 0;
      text-shadow: none;
      position: relative;
      z-index: 2;
    }
    .member-card .status {
      font-size: 1.1rem;
      font-weight: 700;
      text-align: center;
      letter-spacing: 1px;
      margin-top: auto;
      text-shadow: none;
      font-family: 'Orbitron', sans-serif;
      position: relative;
      z-index: 2;
    }
    .member-card .status.active { color: var(--primary); }
    .member-card .status.expired { color: #ff6666; }

    /* Shine effect */
    .member-card.shine-effect { position: relative; overflow: hidden; }
    .member-card.shine-effect::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 60%;
      height: 100%;
      background: linear-gradient(to right, rgba(0, 255, 255, 0) 0%, rgba(0, 255, 255, 0.3) 50%, rgba(0, 255, 255, 0) 100%);
      transform: skewX(-20deg);
      transition: left 0.8s ease;
      pointer-events: none;
      z-index: 5;
    }
    .member-card.shine-effect:hover::before { left: 150%; }

    /* Modal Styling */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      visibility: hidden;
      opacity: 0;
      transition: visibility 0s, opacity 0.3s;
    }
    .modal-overlay.visible { visibility: visible; opacity: 1; }
    .modal-content {
      background: rgba(18, 20, 35, 0.98);
      padding: 2.5rem;
      border-radius: 6px;
      box-shadow: 0 0 25px rgba(0, 191, 255, 0.5);
      text-align: center;
      max-width: 450px;
      width: 90%;
      transform: scale(0.9);
      transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
      border: 1px solid var(--primary);
    }
    .modal-content::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--card-bg-image) no-repeat center center/cover;
      opacity: 0.1;
      z-index: -1;
    }
    .modal-overlay.visible .modal-content { transform: scale(1); }
    .modal-content h3 { color: var(--primary); margin-bottom: 1rem; }
    .modal-content p { margin-bottom: 1.5rem; }

    /* Footer */
    footer {
      text-align: center;
      padding: 2rem;
      background: rgba(0, 0, 0, 0.7);
      color: var(--muted);
      font-size: .9rem;
      border-top: 1px solid rgba(0, 191, 255, 0.1);
    }

    /* Media Queries for Mobile */
    @media (max-width: 767px) {
      .grid-3 { grid-template-columns: 1fr; }
      h1 { font-size: 2.5rem; }
      h2 { font-size: 2rem; }
      h3 { font-size: 1.5rem; }
      section { padding: 3rem 1rem; }
      .btn { padding: .7rem 1.5rem; }
      .card { padding: 1.5rem; }
      .tabs { gap: .5rem; }
      .tab-btn { padding: .5rem 1rem; }
    }
  </style>
</head>
<body>

  <video autoplay muted loop playsinline id="bg-video">
    <source src="https://cdn.pixabay.com/video/2021/08/06/84086-584871133_large.mp4" type="video/mp4">
    <img src="https://placehold.co/1920x1080/080A1A/00BFFF?text=ARAYA+PORTAL" alt="Background">
  </video>

  <section class="hero container" style="text-align:center">
    <h1>ARAYA MEMBER PORTAL</h1>
    <p style="font-size:1.1rem; color: var(--text); text-shadow:0 0 10px rgba(0,255,255,0.4);">Bergabung di komunitas ARAYA GAMESTATION<br>akses benefit, leaderboard, turnamen & promo eksklusif.</p>
    <div style="margin-top:2.5rem">
      <a href="#login" class="btn primary">Login Member</a>
      <a href="#daftar" class="btn accent">Daftar Sekarang</a>
    </div>
  </section>

  <section id="login">
    <div class="container">
      <h2>Login Member</h2>
      <div id="memberBox" class="card">
        <form id="loginForm">
          <input type="text" id="memberName" placeholder="Nama" required>
          <input type="text" id="memberId" placeholder="ID Member" required>
          <button type="submit" class="btn primary">Login</button>
        </form>
      </div>
    </div>
  </section>

  <section id="benefit">
    <div class="container">
      <h2>Tier Membership & Benefit</h2>
      <div class="grid grid-3">
        <div class="card tier bronze">
          <h3>BRONZE</h3>
          <p><strong>Harga:</strong> Rp 50.000</p>
          <ul>
            <li>Akses VIP Per Jam</li>
            <li>Free 1x Bermain PS4 Standar (1 jam / bulan)</li>
            <li>Hadiah langsung untuk Top 3</li>
            <li>Leaderboard (dihitung setiap tanggal 11 Mei)</li>
            <li>Hadiah undian untuk Top 4–7 (1 slot turnamen)</li>
            <li>Masa berlaku keanggotaan 1 bulan</li>
          </ul>
        </div>

        <div class="card tier silver">
          <h3>SILVER</h3>
          <p><strong>Harga:</strong> Rp 100.000</p>
          <ul>
            <li>Akses VIP Per Jam</li>
            <li>Free Bermain PS4 Standar (2 jam / bulan)</li>
            <li>Free 1 Microphone untuk Premiere Room</li>
            <li>Free 1 jam akses VIP Room setiap bulan</li>
            <li>Free 1 User tambahan VIP Room</li>
            <li>Hadiah langsung untuk Top 3</li>
            <li>Leaderboard (dihitung setiap tanggal 11 Mei)</li>
            <li>Hadiah undian untuk Top 4–7 (3 slot turnamen)</li>
            <li>Masa berlaku keanggotaan 3 bulan</li>
          </ul>
        </div>

        <div class="card tier gold">
          <h3>GOLD</h3>
          <p><strong>Harga:</strong> Rp 150.000</p>
          <ul>
            <li>Akses VIP Per Jam</li>
            <li>Free Bermain PS4 Standar (3 jam / bulan)</li>
            <li>Free 2 Microphone untuk Premiere Room</li>
            <li>Free 1 jam akses Premiere Room setiap bulan</li>
            <li>Free 2 User tambahan untuk VIP & Premiere Room</li>
            <li>Hadiah langsung untuk Top 3 Leaderboard (11 Mei)</li>
            <li>Hadiah undian untuk Top 4–7 (6 slot turnamen)</li>
            <li>Masa berlaku keanggotaan 6 bulan</li>
          </ul>
        </div>
      </div>

      <div class="card" style="margin-top:1rem">
        <h3>Syarat & Ketentuan</h3>
        <ul>
          <li>Slot turnamen tiap tier maksimal 1 slot per turnamen.</li>
          <li>Slot turnamen tidak berlaku bila poin bulanan &lt; 250.</li>
          <li>Poin turnamen adalah akumulasi poin bulanan.</li>
          <li>Poin leaderboard adalah akumulasi poin selama masa aktif membership.</li>
          <li>Poin hangus jika membership berakhir tanpa perpanjangan.</li>
          <li>Sisa poin tersimpan jika perpanjangan dilakukan sebelum masa aktif habis.</li>
          <li>Sisa poin hilang jika perpanjangan dilakukan setelah masa aktif habis.</li>
        </ul>
      </div>
    </div>
  </section>

  <section id="leaderboard">
    <div class="container">
      <h2>Leaderboard</h2>
      <div class="tabs">
        <button class="tab-btn active" data-target="all">All Season</button>
        <button class="tab-btn" data-target="s1">Season 1</button>
      </div>
      <div id="leaderboard-container" class="leaderboard-container">
        <table></table>
      </div>
  </section>

  <section id="turnamen">
    <div class="container">
      <h2>Turnamen</h2>
      <div class="card">
        <h3>PES 2025</h3>
        <p>Khusus member</p>
        <a class="btn accent join-btn" id="comingSoonBtn">
          Coming Soon
        </a>
      </div>
    </div>
  </section>

  <section id="daftar">
    <div class="container">
      <h2>Price List</h2>
      <div class="card">
        <ul>
          <li>Bronze: Rp50.000</li>
          <li>Silver: Rp100.000</li>
          <li>Gold: Rp150.000</li>
        </ul>
        <p style="margin-top:.8rem;color:var(--primary)">Daftar/Perpanjang/Upgrade<br>Bisa hubungi admin via WhatsApp di bawah ini.</p>
        <a class="btn primary" style="margin-top:.8rem" target="_blank" href="https://wa.me/6281350502525?text=Halo%20min">
          WhatsApp
        </a>
      </div>
    </div>
  </section>

  <section id="faq">
    <div class="container">
      <h2>FAQ Member</h2>
      <div class="card">
        <h3 style="margin-bottom:.5rem">Cara daftar?</h3>
        <p>Hubungi admin via WhatsApp, pilih tier, lalu lakukan pembayaran.</p>
      </div>
      <div class="card">
        <h3 style="margin-bottom:.5rem">Bisa upgrade tier?</h3>
        <p>Bisa banget, Hubungi admin via WhatsApp, pilih upgarade tier, lalu lakukan pembayaran.</p>
      </div>
      <div class="card">
        <h3 style="margin-bottom:.5rem">Cara ikut turnamen?</h3>
        <p>Login member, lalu klik tombol daftar turnamen yang tersedia.<br>(Syarat & Ketentuan Berlaku)</p>
      </div>
    </div>
  </section>

  <footer>Powered by ARAYA Gamestation</footer>

  <div id="statusModal" class="modal-overlay">
    <div class="modal-content">
      <h3 id="modalTitle"></h3>
      <p id="modalMessage"></p>
      <button class="btn primary" onclick="document.getElementById('statusModal').classList.remove('visible')">OK</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script>
    // Global variables
    let memberData = null;
    let loggedIn = false;
    const isTournamentRegistrationOpen = false;

    // Function to show the custom modal
    function showModal(title, message) {
      const modal = document.getElementById('statusModal');
      document.getElementById('modalTitle').innerText = title;
      document.getElementById('modalMessage').innerText = message;
      modal.classList.add('visible');
    }

    // Function to update the state of the "Join Tournament" button
    function updateJoinButtons() {
      const joinButtons = document.querySelectorAll('.join-btn');
      joinButtons.forEach(btn => {
        if (!isTournamentRegistrationOpen) {
          btn.disabled = true;
          btn.textContent = "Coming Soon";
        } else {
          const isEligible = loggedIn && 
                             memberData && 
                             memberData.STATUS && 
                             memberData.STATUS.toLowerCase() === 'aktif' && 
                             parseInt(memberData['POIN SEASON'], 10) >= 250;
          
          if (isEligible) {
            btn.disabled = false;
            btn.textContent = "Daftar via WhatsApp";
            btn.href = `https://wa.me/6281350502525?text=Halo%20min%20ulun%20mau%20daftar%20turnamen`;
          } else {
            btn.disabled = true;
            btn.textContent = "Daftar via WhatsApp";
            btn.removeAttribute('href');
          }
        }
      });
    }

    // Event handler for the join button
    function handleJoinClick(e) {
      if (!isTournamentRegistrationOpen) {
        e.preventDefault();
        showModal('Pendaftaran Belum Dibuka', 'Pantau terus info terbaru di sosial media kami.');
      } else if (e.target.disabled) {
        e.preventDefault();
        if (!loggedIn) {
          showModal('Login Diperlukan', 'Silakan login terlebih dahulu untuk mendaftar turnamen.');
        } else if (!memberData || !memberData.STATUS || memberData.STATUS.toLowerCase() !== 'aktif') {
          showModal('Status Keanggotaan', 'Status member anda EXPIRED. Silakan perbarui keanggotaan untuk mendaftar.');
        } else if (parseInt(memberData['POIN SEASON'], 10) < 250) {
          showModal('Poin Tidak Cukup', 'Poin Anda untuk season ini kurang dari 250. Perbanyak poin Anda untuk bisa ikut turnamen.');
        } else {
          showModal('Gagal', 'Terjadi kesalahan. Silakan coba lagi atau hubungi admin.');
        }
      }
    }

    document.querySelectorAll('.join-btn').forEach(btn => {
      btn.addEventListener('click', handleJoinClick);
    });
    
    // Google Sheets URLs for member data and leaderboard
    const memberSheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTsla4DIK8GQSXOAj5eMWVCMhThbuEMpcOMZBcYt9mPzKq_OGOS5MiZmlB-y8I9D_OOc9oIbxFaPoE7/pub?gid=0&single=true&output=csv";
    const leaderboardUrls = {
      all: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTsla4DIK8GQSXOAj5eMWVCMhThbuEMpcOMZBcYt9mPzKq_OGOS5MiZmlB-y8I9D_OOc9oIbxFaPoE7/pub?gid=1706144092&single=true&output=csv",
      s1: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTsla4DIK8GQSXOAj5eMWVCMhThbuEMpcOMZBcYt9mPzKq_OGOS5MiZmlB-y8I9D_OOc9oIbxFaPoE7/pub?gid=1706144092&single=true&output=csv",
    };
    
    // Function to load and display leaderboard data
    function loadLeaderboard(seasonKey) {
      const url = leaderboardUrls[seasonKey];
      if (!url) return;
      const container = document.getElementById('leaderboard-container');
      const table = container.querySelector('table');
      container.classList.add('fade-out');

      setTimeout(() => {
        table.innerHTML = ''; 
        Papa.parse(url, {
          download: true,
          header: true,
          complete: function(results) {
            const data = results.data.filter(r => r.NAMA && r.POIN).map(r => ({ NAMA: r.NAMA, POIN: r.POIN }));
            const thead = document.createElement('thead');
            thead.innerHTML = `
              <tr>
                <th>Rank</th>
                <th>Nama</th>
                <th>Point</th>
              </tr>
            `;
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            data.forEach((row, i) => {
              const tr = document.createElement("tr");
              if (i === 0) tr.className = "top1";
              else if (i === 1) tr.className = "top2";
              else if (i === 2) tr.className = "top3";
              const rank = i === 0 ? "🥇" : i === 1 ? "🥈" : i === 2 ? "🥉" : (i + 1);
              tr.innerHTML = `<td>${rank}</td><td>${row.NAMA}</td><td>${row.POIN}</td>`;
              tbody.appendChild(tr);
            });
            table.appendChild(tbody);
            container.classList.remove('fade-out');
          },
          error: function(err) {
            console.error("Gagal load leaderboard:", err);
            container.classList.remove('fade-out');
          }
        });
      }, 300);
    }

    // Initial load on page content loaded
    document.addEventListener('DOMContentLoaded', () => {
      loadLeaderboard("all");
      updateJoinButtons();
    });

    // Event listener for leaderboard tabs
    document.querySelectorAll(".tab-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        const target = btn.dataset.target;
        loadLeaderboard(target);
      });
    });

    // Event listener for the login form submission
    document.getElementById("loginForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const inputName = document.getElementById("memberName").value.trim().toLowerCase();
      const inputId = document.getElementById("memberId").value.trim().toLowerCase();
      Papa.parse(memberSheetUrl, {
        download: true,
        header: true,
        complete: function(results) {
          const data = results.data;
          const member = data.find(row => 
            row["NAMA"]?.toLowerCase() === inputName &&
            row["ID MEMBER"]?.toLowerCase() === inputId
          );
          const box = document.getElementById("memberBox");
          box.innerHTML = "";

          if (member) {
            loggedIn = true;
            memberData = member;
            const tier = (member["TIER"] || '').toLowerCase();
            const status = (member["STATUS"] || '').toLowerCase();
            const start = member["START"] || 'N/A';
            const expired = member["EXPIRED"] || 'N/A';
            const statusClass = status === 'aktif' ? 'active' : 'expired';
            
            box.innerHTML = `
              <div class="member-card shine-effect">
                <h3>ARAYA MEMBER</h3>
                <p class="id">${member["ID MEMBER"] || 'N/A'}</p>
                <p class="name">${member["NAMA"] || 'N/A'}</p>
                <p class="tier ${tier}">${member["TIER"] || 'N/A'}</p>
                <p class="validity">${start} – ${expired}</p>
                <p class="status ${statusClass}">${member["STATUS"] || 'Unknown'}</p>
              </div>
              <div style="text-align:center;margin-top:.8rem">
                <button class="btn ghost" onclick="location.reload()">Logout</button>
              </div>
            `;
            console.log("Login berhasil. Data member:", memberData);
            updateJoinButtons();
          } else {
            loggedIn = false;
            memberData = null;
            box.innerHTML = `
              <div class="card" style="text-align:center">
                <h3>Belum Terdaftar</h3>
                <p>Nama atau ID tidak ditemukan.</p>
                <p>Silakan daftar untuk menjadi member.</p>
                <button class="btn ghost" onclick="location.reload()">Kembali</button>
              </div>
            `;
            console.log("Login gagal. Nama atau ID tidak ditemukan.");
            updateJoinButtons();
          }
        },
        error: function(err, file) {
            console.error("Gagal memuat data, Pastikan data dapat diakses publik.", err);
            showModal('Kesalahan Jaringan', 'Gagal memuat data member. Silakan periksa koneksi internet Anda atau hubungi admin.');
        }
      });
    });
  </script>

</body>
</html>